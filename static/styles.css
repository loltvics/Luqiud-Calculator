
*,
*::before,
*::after{
  box-sizing:border-box;
}

:root{
  --bg1:#020617;
  --bg2:#0b1220;
  --accent:#38bdf8;
  --accent-soft:rgba(56,189,248,0.18);
  --text-main:#e5f0ff;
  --text-soft:#9ca3af;
  --danger:#f97373;
  --glass-bg:rgba(15,23,42,0.78);
  --glass-soft:rgba(15,23,42,0.6);
  --border-soft:rgba(148,163,184,0.28);
  --shadow-soft:0 24px 60px rgba(15,23,42,0.8);
  --radius-xl:28px;
  --radius-lg:22px;
  --radius-md:18px;
  --radius-pill:999px;
}

html, body{
  margin:0;
  padding:0;
  height:100%;
  font-family:-apple-system,BlinkMacSystemFont,'SF Pro Text','Inter',system-ui,sans-serif;
  color:var(--text-main);
  background:radial-gradient(circle at 0% 10%,#1d4ed8 0,transparent 55%),
             radial-gradient(circle at 100% 90%,#0f766e 0,transparent 55%),
             radial-gradient(circle at 50% 50%,#020617 0,#020617 100%);
  overflow-x:hidden;
}

/* background blobs */

.bg{
  position:fixed;
  inset:0;
  pointer-events:none;
  overflow:hidden;
  z-index:-2;
}

.blob{
  position:absolute;
  width:420px;
  height:420px;
  border-radius:999px;
  filter:blur(40px);
  opacity:0.9;
}

.b1{
  background:#1d4ed8;
  top:-80px;
  left:-120px;
}

.b2{
  background:#22c55e;
  bottom:-120px;
  right:-40px;
}

.b3{
  background:#e11d48;
  top:40%;
  right:55%;
}

.grain{
  position:absolute;
  inset:-40px;
  background-image:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='160' height='160' viewBox='0 0 160 160'%3E%3Cfilter id='n'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='.9' numOctaves='3' stitchTiles='noStitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23n)' opacity='0.4'/%3E%3C/svg%3E");
  mix-blend-mode:soft-light;
  opacity:0.6;
  pointer-events:none;
}

/* layout */

.wrap{
  min-height:100vh;
  display:flex;
  flex-direction:column;
  padding:24px;
}

.topbar{
  display:flex;
  align-items:center;
  justify-content:space-between;
  max-width:960px;
  margin:0 auto 20px;
}

.brand{
  display:flex;
  align-items:center;
  gap:14px;
}

.logo{
  width:44px;
  height:44px;
  border-radius:24px;
  background:radial-gradient(circle at 30% 20%,#7dd3fc,transparent 55%),
             radial-gradient(circle at 70% 80%,#0ea5e9,transparent 55%),
             rgba(15,23,42,0.95);
  box-shadow:0 20px 45px rgba(15,23,42,0.9);
  display:flex;
  align-items:center;
  justify-content:center;
  position:relative;
}

.logo::after{
  content:"";
  width:16px;
  height:16px;
  border-radius:999px;
  background:#22c55e;
  border:2px solid rgba(15,23,42,0.9);
  position:absolute;
  bottom:4px;
  right:4px;
}

.logo-icon{
  width:20px;
  height:20px;
}

.title-block{
  display:flex;
  flex-direction:column;
  gap:2px;
}

.title{
  font-weight:600;
  letter-spacing:0.04em;
  font-size:18px;
}

.subtitle{
  font-size:12px;
  color:var(--text-soft);
}

.version-tag{
  padding:6px 12px;
  border-radius:999px;
  border:1px solid rgba(148,163,184,0.35);
  background:linear-gradient(120deg,rgba(15,23,42,0.8),rgba(30,64,175,0.55));
  color:var(--text-soft);
  font-size:11px;
  display:flex;
  align-items:center;
  gap:6px;
  box-shadow:0 16px 40px rgba(15,23,42,0.9);
}

.pill-dot{
  width:6px;
  height:6px;
  border-radius:999px;
  background:#22c55e;
}

/* calc shell */

.main-row{
  display:flex;
  align-items:flex-start;
  justify-content:center;
  gap:32px;
  flex-wrap:wrap;
  width:100%;
  max-width:960px;
  margin:0 auto 24px;
}

.calc-shell{
  width:360px;
  border-radius:var(--radius-xl);
  padding:18px 18px 22px;
  background:linear-gradient(145deg,rgba(15,23,42,0.86),rgba(15,23,42,0.72));
  border:1px solid rgba(148,163,184,0.35);
  box-shadow:var(--shadow-soft);
  backdrop-filter:blur(28px) saturate(160%);
}

.display{
  border-radius:var(--radius-lg);
  padding:16px 18px 18px;
  background:radial-gradient(circle at 0 0,rgba(148,163,184,0.16),transparent 65%),
             rgba(15,23,42,0.9);
  border:1px solid rgba(148,163,184,0.33);
  margin-bottom:16px;
}

.history{
  min-height:18px;
  font-size:13px;
  color:var(--text-soft);
  opacity:0.9;
}

.expression{
  margin-top:4px;
  font-size:32px;
  line-height:1.3;
  text-align:right;
}

/* keys */

.keys{
  display:grid;
  grid-template-columns:repeat(4,1fr);
  gap:10px;
}

.key{
  border:none;
  outline:none;
  cursor:pointer;
  font-size:16px;
  font-weight:500;
  color:var(--text-main);
}

.glass-btn{
  border-radius:18px;
  padding:10px 0;
  border:1px solid var(--border-soft);
  background:radial-gradient(circle at 0 0,rgba(148,163,184,0.2),transparent 60%),
             rgba(15,23,42,0.88);
  box-shadow:0 14px 30px rgba(15,23,42,0.7);
  transition:transform .12s ease, box-shadow .12s ease, border-color .12s ease, background .12s ease;
}

.glass-btn.soft{
  background:linear-gradient(145deg,rgba(15,23,42,0.85),rgba(51,65,85,0.82));
}

.glass-btn.op{
  background:linear-gradient(145deg,rgba(30,64,175,0.9),rgba(59,130,246,0.85));
}

.glass-btn.equals{
  background:linear-gradient(145deg,#22c55e,#16a34a);
}

.span2{
  grid-column:span 2;
}

.key:active{
  transform:translateY(1px) scale(0.99);
  box-shadow:0 8px 18px rgba(15,23,42,0.7);
}

/* hint */

.hint{
  margin-top:14px;
  font-size:11px;
  color:var(--text-soft);
  text-align:center;
  line-height:1.5;
}

/* AI overlay */

.ai-toggle{
  display:flex;
  align-items:center;
  gap:8px;
}

.toggle-pill{
  border-radius:999px;
  border:1px solid rgba(148,163,184,0.4);
  padding:4px 10px;
  background:rgba(15,23,42,0.9);
  font-size:11px;
  color:var(--text-soft);
  cursor:pointer;
}

.ai-overlay{
  position:fixed;
  inset:0;
  background:radial-gradient(circle at 0 0,rgba(15,23,42,0.85),rgba(15,23,42,0.96));
  backdrop-filter:blur(26px);
  display:flex;
  align-items:flex-end;
  justify-content:center;
  padding:18px;
  z-index:40;
}

.ai-overlay.hidden{
  display:none;
}

.ai-sheet{
  width:100%;
  max-width:620px;
  border-radius:28px 28px 22px 22px;
  background:linear-gradient(145deg,rgba(15,23,42,0.96),rgba(17,24,39,0.92));
  border:1px solid rgba(148,163,184,0.4);
  box-shadow:0 24px 70px rgba(15,23,42,0.95);
  padding:16px 18px 18px;
}

.ai-head{
  display:flex;
  align-items:center;
  justify-content:space-between;
  gap:12px;
  margin-bottom:12px;
}

.ai-title{
  display:flex;
  align-items:center;
  gap:8px;
  font-size:15px;
  font-weight:500;
}

.ai-dot{
  width:8px;
  height:8px;
  border-radius:999px;
  background:#22c55e;
  box-shadow:0 0 12px rgba(34,197,94,0.8);
}

.ai-close{
  border-radius:999px;
  border:1px solid rgba(148,163,184,0.5);
  background:rgba(15,23,42,0.9);
  color:var(--text-soft);
  padding:6px 12px;
  font-size:11px;
  cursor:pointer;
}

.ai-body{
  display:flex;
  flex-direction:column;
  gap:10px;
}

.ai-input-wrap{
  display:flex;
  gap:10px;
}

.ai-input{
  flex:1;
  border-radius:18px;
  border:1px solid rgba(148,163,184,0.4);
  background:rgba(15,23,42,0.9);
  padding:10px 12px;
  font-size:13px;
  color:var(--text-main);
  outline:none;
}

.ai-input::placeholder{
  color:rgba(148,163,184,0.8);
}

.ai-solve{
  padding-inline:16px;
  font-size:13px;
}

.ai-output{
  max-height:260px;
  overflow:auto;
  border-radius:18px;
  border:1px solid rgba(51,65,85,0.9);
  background:radial-gradient(circle at 0 0,rgba(55,65,81,0.4),transparent 65%),
             rgba(15,23,42,0.96);
  padding:10px 12px;
  font-size:13px;
}

.step{
  padding:6px 8px;
  border-radius:12px;
  background:rgba(15,23,42,0.9);
  margin-bottom:6px;
}

.step.final{
  background:linear-gradient(135deg,rgba(34,197,94,0.16),rgba(8,47,73,0.8));
  border:1px solid rgba(34,197,94,0.65);
}

.step.error{
  background:linear-gradient(135deg,rgba(248,113,113,0.16),rgba(88,28,28,0.9));
  border:1px solid rgba(248,113,113,0.7);
}

/* footer */

.footer{
  max-width:960px;
  margin:0 auto 8px;
  padding:8px 12px;
  font-size:11px;
  color:var(--text-soft);
  text-align:center;
  opacity:0.9;
}

/* responsive */

@media (max-width:768px){
  .wrap{
    padding:18px 14px 22px;
  }
  .topbar{
    flex-direction:column;
    align-items:flex-start;
    gap:10px;
  }
  .calc-shell{
    width:100%;
  }
  .ai-sheet{
    border-radius:22px;
  }
}
